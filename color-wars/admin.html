<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel</title>
    <style>
        body { background: #050a14; color: #fff; font-family: sans-serif; padding: 20px; }
        .trx { background: #0a1020; padding: 15px; margin-bottom: 10px; border-radius: 10px; border-left: 5px solid #00D1FF; }
        .btn { padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; margin-right: 10px; }
        .aprob { background: #00ff88; color: #000; }
        .rechz { background: #ff0055; color: #fff; }
    </style>
</head>
<body>
    <h1>PANEL DE CONTROL (PAGOS/RETIROS)</h1>
    <div id="lista">Cargando...</div>

    <script>
        async function cargar(){
            const res = await fetch('/api/admin/trx');
            const data = await res.json();
            let html = '';
            data.pendientes.forEach(t => {
                html += `
                <div class="trx">
                    <b>USUARIO:</b> ${t.email} <br>
                    <b>TIPO:</b> ${t.tipo.toUpperCase()} | <b>MONTO:</b> $${t.monto} <br>
                    <b>INFO/REF:</b> ${t.info} <br><br>
                    <button class="btn aprob" onclick="procesar(${t.id}, 'aprobar')">APROBAR</button>
                    <button class="btn rechz" onclick="procesar(${t.id}, 'rechazar')">RECHAZAR</button>
                </div>`;
            });
            document.getElementById('lista').innerHTML = html || 'No hay nada pendiente';
        }

        async function procesar(id, accion){
            await fetch('/api/admin/procesar', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ id, accion })
            });
            cargar();
        }
        cargar();
        setInterval(cargar, 5000);
    </script>
</body>
</html>
